
params {
    global {
        // genome_assembly = '' // hg38 or dm6
    }
    sc {
        scenic {
            // Label for the processes
            //labels {
            //    processExecutor = 'qsub'
            //}
            container = 'aertslab/sctx-pyscenic:0.9.19'
            scenicoutdir = "${params.global.outdir}/scenic/"
            report_ipynb = '/src/scenic/bin/reports/scenic_report.ipynb'
            filteredLoom = '/ddn1/vol1/staging/leuven/stg_00002/lcb/cflerin/testruns/scenic-nf_testing/expr_mat.loom' // for testing
            scenicOutputLoom = 'SCENIC_output.loom'
            scenicScopeOutputLoom = 'SCENIC_SCope_output.loom'
            // computation arguments:
            mode = 'dask_multiprocessing'
            client_or_address = ''
            // loom file arguments:
            cell_id_attribute = 'CellID'
            gene_attribute = 'Gene'
            grn {
                seed = ''
                // cluster options:
                pmem = '2gb'
                maxForks = 1
                numWorkers = 2
            }
            cistarget {
                adj = 'adj.tsv'
                // motif feather format databases
                // mtfDB = '/ddn1/vol1/staging/leuven/stg_00002/lcb/cflerin/testruns/scenic-nf_testing/genome-ranking.feather' // for testing
                // motif annotations
                // mtfANN = '/ddn1/vol1/staging/leuven/stg_00002/lcb/cflerin/testruns/scenic-nf_testing/motifs.tbl' // for testing
                type = ''
                output = 'reg.csv'
                /*
                --no_pruning
                --chunk_size
                --all_modules
                --transpose
                */

                // motif enrichment arguments:
                rank_threshold = 5000
                auc_threshold = 0.05
                nes_threshold = 3.0
                // motif annotation arguments:
                min_orthologous_identity = 0.0
                max_similarity_fdr = 0.001
                annotations_fname = ''
                // module generation arguments:
                thresholds = '0.75,0.90'
                top_n_targets = 50
                top_n_regulators = '5,10,50'
                min_genes = 20
                // expression_mtx_fname = '' // uses params.scenic.filteredLoom
                // Resources settings
                pmem = '2gb'
                maxForks = 1
                numWorkers = 2
            }
            aucell {
                output = 'aucell_output.loom'
                // motif enrichment arguments:
                rank_threshold = 5000
                auc_threshold = 0.05
                nes_threshold = 3.0
                // Resources settings
                pmem = '2gb'
                maxForks = 1
                numWorkers = 2
            }
        }
    }
}

if(!params.global.containsKey("genome_assembly"))
    return

if(params.global.genome_assembly == 'dm6') {
    includeConfig 'conf/min/dbs/cistarget-motifs-fly-dm6-v0.0.1.config'
    includeConfig 'conf/min/dbs/cistarget-tracks-fly-dm6-v0.0.1.config'
    includeConfig 'conf/min/tfs/fly-v0.0.1.config'
} else if(params.global.genome_assembly == 'hg38') {
    includeConfig 'conf/min/dbs/cistarget-motifs-human-hg38-v0.0.1.config'
    includeConfig 'conf/min/dbs/cistarget-tracks-human-hg38-v0.0.1.config'
    includeConfig 'conf/min/tfs/human-v0.0.1.config'
}
